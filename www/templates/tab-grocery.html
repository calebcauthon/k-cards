<ion-view view-title='Grocery'>
  <ion-nav-buttons side="left">
    <a href="#/tab/dash">
      <button class="button back-button hide buttons button-clear header-item">
        <i class="icon ion-ios-arrow-back"></i>
        <span class="back-text" style="display: inline-block;">
          <span class="default-title">Recipes</span>
        </span>
      </button>
    </a>
  </ion-nav-buttons>

  <ion-nav-buttons side="right">
    <a href="#/recipe/{{id}}/all-groceries">
      <button class="button back-button hide buttons  button-clear header-item">
        <span class="back-text" style="display: inline-block;">
          <span class="default-title">All Groceries</span>
        </span>
        <i class="icon ion-ios-arrow-forward"></i>
      </button>
    </a>
  </ion-nav-buttons>

  <ion-content class="padding">
    <div class="row">
      <div class="col">
        {{recipe.name}}
      </div>
      <div class="col col-75">
        <span>{{(recipe.serving_ratio || 1) * recipe.serving_size}} servings</span>
        <span ng-show="recipe.serving_ratio != 1">
          / {{recipe.serving_ratio}}x
        </span>
      </div>
    </div>
    <div class="row">
      <div class="col col-75">
        <button
          ng-hide="isInGroceryList(ingredients)"
          ng-click="addToGroceryList(ingredients)"
          class="button button-balanced">Add to grocery list</button>
        <button
          ng-hide="isInGroceryList(ingredients)"
          ng-click="askHowMuch(ingredeints)"
          class="button button-balanced"><i class="icon ion-more"></i></button>
        <button
          ng-show="isInGroceryList(ingredients)"
          ng-click="removeFromGroceryList(ingredients)"
          class="button button-assertive">Remove from grocery list</button>
      </div>
    </div>

    <div class="list list-inset">
      <div
        ng-repeat="ingredient in ingredients | orderBy:'text'"
        ng-click="toggleGroceryList(ingredient)"
        class="item item-radio">
          <div class="radio-content">
            <div class="item-content">
              {{ingredient.text}} 
              ({{ingredient.amount * (recipe.serving_ratio || 1)}}<span ng-if="ingredient.measurement"> {{ingredient.measurement}}</span>)
            </div>
            <i
              ng-class="{ 'checked': isInGroceryList(ingredient) }"
              class="radio-icon ion-checkmark"></i>
          </div>
      </div>
    </div>
  </ion-content>
</ion-view>
